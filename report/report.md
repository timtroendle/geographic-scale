# Main text

A large body of work has shown that 100% or near-100% renewable electricity provision through solar, wind, and hydro power is technically possible and economically viable in Europe. Solar and wind generation technologies are increasingly mature [@Brown:2018; @IRENA:2019], there is enough land for the infrastructure required [@McKenna:2015; @Jacobson:2017; @Bodis:2019; @Trondle:2019], future costs will likely be similar to today’s costs [@Bussar:2014; @Connolly:2016; @Plessmann:2017; @Jacobson:2017; @Brown:2018; @Child:2019], and a variety of options is available to balance variable renewable generation on time scales ranging from hours to years [@Rasmussen:2012; @Luo:2015; @Grams:2017; @Schlachtberger:2017; @Brown:2018]. However, not every strategy is available on every geographical scale, as regions are endowed with different and differently large resources. Further, each strategy to deal with this variability leads to trade-offs across areas as diverse as cost, governance and political control, and landscape impacts [@Lilliestam:2016].

These tradeoffs depend on how the system is designed, and where on the spectrum between small-scale bottom-up and vast-scale top-down the key system elements are located. On one end of the spectrum are small-scale solutions, where renewable variability is balanced locally using electricity storage and the dispatchable resources available, or by supplementing variable generation with flexible biomass-based generation without the need for vast transmission structure. Such a locally self-sufficient future is in principle possible in Europe [@Trondle:2019], but how the flexibility supply affects the costs in all parts of Europe is not known. On the other end are large-scale solutions, relying on stochastic smoothing of supply through large grids, spanning an entire continent or more, making efficient use of dispatchable resources regardless of where they are located [@Patt:2011; @Dii:2012; @Grams:2017; @Mano:2014; @Benasla:2019]. Hence, there is reason to expect that a continent-spanning system is cheaper than smaller, self-sufficient systems [@Schmid:2015; @Schlachtberger:2017; @Brown:2018a]. However, it is not known how large this cost difference is --- and as ideas of citizen power, small is beautiful, and local control have great appeal to many, citizens and decision-makers alike, the trade-off between geographical scope and cost is a real political question [@Schmidt:2012; @Scheer:2012; @100RESCommunities:2015; @FriendsoftheEarth:2018]. As the pathways to achieve them may be very different [@Foxon:2013; @Hughes:2013], the question of which path has which consequences is both important and pressing.

Here we investigate how the geographic scale of a fully renewable European electricity system affects costs and optimal system design, that is, the power mix and the spatial configuration of generation and transmission capacities. We investigate integration, or electricity self-sufficiency, on three scales: continental, national, and regional (the first-level administrative divisions). To quantify cost differences for systems on different geographic scales as well as the influence of spatial scale on optimal system design, we develop a linear programming model that considers solar, wind, hydropower, and bioenergy, based on the Calliope framework [29]. Our model minimises system cost by simultaneously optimising design and operation of the electricity system. The model is spatially resolved to first-level administrative divisions (497 regions) and runs at a 4-hour temporal resolution. We perform a global sensitivity analysis on a surrogate model, permitting us to explore a large range of uncertainties and sensitivities despite the fact that the main model is computationally difficult to solve.

# System scale drives system cost: larger is cheaper

We first assess the impact of system scale on total system cost and find, as expected, that system cost increases when system scale decreases. For a continental scale transmission grid, we find system cost corresponding to about 0.05 € per kWh electricity demand, roughly comparable to today’s cost. However, when we consider transmission grids span countries only, with 33 isolated national grids and no trade between them, the costs rise to nearly 140%. When we decrease grid scale even further and consider no exchange between 497 self-sufficient regions in Europe, cost rises to 170% of the system with continental scale grid (Figure @fig:scenario-space a). <mark>This relationship is robust and not strongly affected by cost uncertainties: although the cost differences vary, the continental system is always lower-cost than the national scale system (see Supplementary Figure 1).</mark>

![**System cost of twelve electricity systems on three different scales in Europe with and without lower level net self-sufficiency, relative to lowest cost, continental scale system.** **a,** Cost of cases without lower level net self-sufficiency with systems on continental (one system), national (33 isolated systems), and regional (497 isolated systems) scale. All cost values are relative to the continental case. **b**, Cost of cases with lower level net self-sufficiency within continental scale systems (left two columns) and within national scale systems (rightmost column). The cases include national and regional extents of net self-sufficiency (x-axis), in which countries or regions fulfil the largest part of their demand with electricity generated within the country or region. The cases include different levels of allowed net imports as well (y-axis), from no net imports until imports covering up to 30% of national or regional electricity demand.](report/scenario-space.png){#fig:scenario-space .class}

System cost of twelve optimised European electricity systems that vary on grid scale (labelled across top of figure), extent of self-sufficiency (x-axis), and allowed net imports (y-axis), relative to the base case lowest-cost continental scale grid. [text to clearly differentiate base cases from additional cases in the figure] a, Cost of continental scale systems in which a transmission grid spans the entire continent. In addition to the unconstrained case (framed), there are six cases with national and regional self-sufficiency in which national or regional annual electricity demand is fulfilled mostly (top and middle rows) or completely (bottom row) by national/regional electricity generation, within the continental-scale grid. b, Cost of national scale systems in which transmission grids connect regions within countries, but do not cross country borders. In addition to the otherwise unconstrained case (framed), there are three cases with regional self-sufficiency in which regional annual electricity demand is fulfilled mostly (top and middle rows) or completely (bottom row) by electricity generation within regions. c, Cost of regional scale electricity system. In this case, all regions are completely self-sufficient, i.e. not connected to other regions.

The larger grids are lower-cost because flexibility options available in some areas of Europe can be used to balance the system for the continent as a whole, including for those regions that lack such resources locally. Further, larger grids can be supplied with electricity from the best sites, as the potential on a continental scale is sufficient to discard marginal sites, leading to a correspondingly lower generation cost.

To test the impact of these two aspects on system cost, we enforce national and regional self-sufficiency in larger scale systems, either with only gross trade for balancing (bottom row in Figure @fig:scenario-space), or with some net import allowed (middle and top row). We find that local self-sufficiency has not a large impact on cost: system cost rises to 106% for national self-sufficiency and to 121% for regional self-sufficiency in the continental scale system. Net imports, consequently, have only minor impact on system cost as well: allowing for 30% net imports between countries within a continental grid, for example, reduces cost from 106% of the base case cost to 102% (Figure @fig:scenario-space a); the effect of trade within otherwise unconnected countries (Figure @fig:scenario-space b) is similarly small, from 147% to 142% of the base case cost. Thus, national or regional self-sufficiency is not necessarily much more expensive than continental scale supply, if there is a strong transmission grid used to balance fluctuations of renewable generation. There is a trade-off between system scale and cost, but not necessarily between self-sufficiency and cost.

# System scale drives system design and operation

Cost optimal electricity systems with different geographic scales have different compositions of supply and support technologies, with some technologies being dominant in large systems and others in smaller systems, as different resources are available in different parts of the continent. In addition, the components are also differently operated depending on the geographic scale of the system. Indeed, the differences in system cost are driven by these differences in compositions and operations.

Small scale systems require significantly more generation capacity than large scale systems (Figure @fig:composition a), as many regional systems must rely on poor generation sites to meet their annual demand. Regional systems rely more on solar PV than on wind --- as decent PV resources are available across the continent, but not every locality has good wind resources --- so that the regional scale systems have more capacity, but a lower generation potential than the continental scale system (Figure @fig:composition a,d). This increased investment need drives system cost, so that supply of smaller systems is more expensive than that of larger ones.

![**Cost minimal electricity system designs for all cases. a,b,c,d**, Europe wide installed generation capacities (**a**), storage capacities (**b**), transmission capacities (**c**), and  potential and curtailed generation from variable renewable sources (**d**) for continental, national, and regional scale electricity systems with minimal system cost. The thin bars indicate the range of values for cases with different forms of local self-sufficiency within continental and national scale systems. See Supplementary Tables 3 and 4 for numeric results of all twelve scenarios. **a**, Europe wide installed capacities of onshore and offshore wind (Wind), open-field and roof mounted solar (Solar), bioenergy (Bio), battery storage (Battery), hydrogen storage (Hydrogen), and the total installed capacities (Total). The total excludes all storage capacities but includes capacities of hydro electricity which are fixed in all scenarios (36 GW run of river, 103 GW reservoirs). **b**, Europe wide installed storage capacities for battery and hydrogen storage. 97 TWh from hydro reservoirs and 1.3 TWh from pumped hydro storage are fixed in all scenarios and not shown. **c**, Europe wide installed electricity transmission capacities, ignoring transmission capacities within regions. **d**, Europe wide potential and curtailed generation from the variable renewable sources solar, wind and hydro.](report/composition.png){#fig:composition .class}

The largest effects concern storage, transmission, and flexible generation from biomass, and there is a very strong trade-off between them. As the continental scale system relies heavily on the grid to balance fluctuations, sometimes across very large distances, it sees great expansion of the transmission grid to about 400 TWkm, some 4 times the current European transmission system [@ENTSO-E:2019]. Using this capacity, about 3,000 TWh/year cross country borders, which, again, is roughly 4 times current cross-border electricity flows and is comparable to the entire European electricity demand [@ENTSO-E:2019]. Of those 3,000 TWh, roughly half remain as net imports within countries, which is more than 7 times the amount of today [@ENTSO-E:2019].

Because they use the transmission grid to connect resources, larger electricity systems require fewer total flexibility options, such as dispatchable generation and storage. Indeed we find that the system with continental scale grid contains only moderate amounts of short-term electricity storage, long-term electricity storage, and bioenergy capacity, and requires less curtailment of renewable electricity than systems with smaller grids, see Figure @fig:composition. Larger systems generate the majority of their renewable electricity from onshore wind resources, both because of the low levelised cost of electricity of onshore wind at the best locations in Europe, but also because systems with continental grids can exploit the weather patterns of wind all over Europe on multiple timescales --- an ability that has been shown in previous literature [@Kempton:2010; @Grams:2017] and which exists for photovoltaics only for short timescales of up to several hours.

When we enforce national or regional self-sufficiency in larger scale systems, we see that the supply structure resembles the one of national or regional scale systems (black bars in Figure @fig:composition): here as well, large amounts of wind and solar capacities are necessary. However, we only see a moderate increase of flexibility capacities. There are more storage capacities and more biofuel capacities installed, but the levels are still much lower than those of small scale systems. Instead, flexibility here comes through the transmission grid and through over capacities of renewable generation and their curtailment. Thus, while large scale systems with national or regional self-sufficiency resemble small scale systems on the supply side, they do not resemble them on the flexibility side. This explains the large cost difference: electricity generation cost is roughly equal, but flexibility cost is much higher for small scale systems.

When we consider uncertainty in model inputs, we find that the differences in composition of continental, national, and regional scale systems are not very sensitive towards this uncertainty, see Figure @fig:variability. We find that cost optimal national and regional scale systems always come with more combined bioenergy and storage capacity, almost always come with more total supply capacity, and often come with less wind capacity than cost optimal continental scale systems. There are, however, large differences in absolute numbers: total supply capacity ranges from below 1 TW to more than 2 TW, wind capacity ranges from almost 0 to sometimes more than 1 TW, and combined flexibility capacity from bioenergy and storage ranges from almost 0 to more than 0.75 TW. While the composition difference between systems on different scales is not very sensitive towards input uncertainty, compositions of the systems themselves are.

![**Variability of capacities installed in electricity systems  of all scales considering uncertainty in input parameters. a,b,c,d,e,f,** Each panel shows a bivariate histogram of the joint distribution of variability within continental and national (**a,b,c**), and continental and regional scale systems (**d,e,f**). Darker colours indicate more occurrences of values within 100,000 samples of each surrogate model. **a,d,** Variability of total supply capacity comprising wind, solar, hydro, and bioenergy capacities. **b,e,** Variability of onshore and offshore wind capacity. **c,f,** Variability of bioenergy, short-term storage, and long-term storage capacities. For a detailed compilation of all considered input uncertainty, see Supplementary Table 5.](report/composition-variability.png){#fig:variability .class}

# System scale has varying influence on countries and regions

Locally, in countries and regions in Europe, the composition of the electricity system is very diverse and again dependent on the scale of the electricity system. For the case of the continental system, some countries and regions are equipped with much more generation capacities than others: Ireland, Lithuania, Estonia, and Albania all generate more than 4 times of what they actually consume. Large parts of their land are used to farm electricity for export. This effect is even more pronounced in single regions: several Irish counties facing the Atlantic ocean --- like Mayo, Kerry, or Cork ---, the Swedish island Gotland in the baltic sea, or Tulcea County at the Romanian shore of the black sea generate more than 50 times than what they need for themselves (Figure @fig:map-energy a). Some of these exports are transmitted over long distances to their destinations and cross many regions. In extreme cases, this amounts to more than 250 times local demand being transferred through a node of the system. Examples are the central Ireland counties Laoighis, Tipperary, or Meath, through which electricity from onshore wind turbines at the Atlantic ocean pass to the UK and onwards to central Europe (Figure @fig:map-energy b). These Irish regions, but also other regions in Romania, Estonia, Montenegro, Switzerland, and other countries passing through large amounts of electricity are faced with large installations of transmission capacities which they do not, or only marginally benefit from directly. On the receiving end of these electricity trades are regions and countries that rely heavily, or sometimes completely, on imports: Belgium, Czech Republic, and Germany all feed less than 10% of their electricity demand from local sources.

![**Distribution of relative generation and transmission over Europe for the continental scale system. a,b,** Electricity generated (**a**) and electricity transmitted (**b**) for each region in Europe. The values are relative to local electricity demand.](report/map-energy.png){#fig:map-energy .class}

On the other end of the scale, when regional electricity systems are isolated, levelised cost of electricity varies strongly between regions, depending on the renewable resources each region has available (Figure @fig:map-cost). About 10% of regions (and a few countries) have costs below those of the continental case (blue regions in Figure @fig:map-cost). This is, however, a result of the lack of installation cost of hydro electricity in our model (see Methods). All these regions can either generate or store electricity using water, with capacities covering at least 40% of peak demand, and their levelised cost of electricity would be higher should we consider installation cost for hydro electricity. Another 10% of regions have costs at least double those of the continental case, and for half of them, 5% of the total, costs are at least four times higher. These expensive regions share at least one of the following features: large (existing) hydro capacities, and low or no potential for wind power.

![**System cost normed by demand for strictly self-sufficient units on national and regional electricity system scales, relative to lowest cost, continental scale case.** Strict self-sufficiency does not allow for any form of exchange of electricity between units. Each panel shows the system scale and the Europe wide relative total system cost. **a**, Relative system cost for each self-sufficient country. **b**, Relative system cost for each self-sufficient region.](report/map-cost.png){#fig:map-cost .class}

Because we force hydro capacities to exist where they exist today (see Methods), regions with hydro generation exceeding local demand have high generation cost due to high fixed cost for operation and maintenance. This is the case for several mountainous and rural regions, in the Alps (e.g. Grisons, Valais, Valle d’Aosta) but also elsewhere, such as Nikšic in Montenegro or Jämtland in Sweden. Of course, this is an artefact of the regional scale: these large hydro capacities were built to power nations, not small, weakly populated parts of these countries.

Several regions have low or no potential for wind capacities and thus their main source of electricity is the sun. As solar generation has strong seasonal fluctuations in Europe (see Figure @fig:timeseries b), these regions require more flexible generation from bioenergy (see Figure @fig:timeseries d) or hydroelectricity, or long-term electricity storage. Where the potentials for wind and hydroelectricity are low, cost of flexible generation and thus system cost is particularly high. This is for two reasons. First, because bioenergy is an expensive source of electricity, and its LCOE is higher with lower utilisation. Second, hydrogen storage needs to be used to balance seasonal fluctuations in these regions, instead of using it to balance fluctuations between weeks and consecutive months for which it is cost optimal (see Figure @fig:timeseries f).

![**Distribution of time series for all regions of the regional scale electricity system. a,b,c,d,e,f,** Distribution of time series for all regions with low flexibility cost (combined cost of bioenergy, hydrogen, and battery storage) (**a,b,c**) and all regions whose flexibility cost lies within the highest decile (**d,e,f**). **a,b,** Combined wind and solar weekly generation potential time series relative to local demand. Seasonal fluctuations are more pronounced for the case with higher cost due to higher shares of solar electricity. Regions with high solar shares are often urban regions with low or no wind potential. **c,d,** Weekly generation time series from biomass combustion relative to demand. Generation has a more pronounced seasonality and is generally larger in regions with higher flexibility cost. **e,f,** Weekly time series of hydrogen storage levels relative to installed storage capacity. In regions with higher cost, hydrogen storage is used primarily to balance seasonal fluctuations, instead of balancing fluctuations within weeks or months as it is done for lower cost regions, leading to fewer storage cycles and higher cost.](report/timeseries.png){#fig:timeseries .class}

# Global sensitivity analysis

While our main results are not sensitive to meteorological conditions (see Methods), they are sensitive to other input parameters, especially costs. Above, we show the variability of the additional cost of national scale compared to continental scale electricity systems. To identify which of the input parameters are driving the variability of the result the most, we perform a global sensitivity analysis. This gives us the magnitude with which the uncertainty of a single input parameter explains the variability of a single output parameter either directly or in combination with other parameters; a quantity called Total Sobol’ index. We find that the uncertainty of three input parameters explains almost the entire variability of the additional cost of national scale systems: discount rate, cost of bioenergy combustion capacity, and cost of onshore wind capacity (framed boxes in Figure @fig:sobol). The discount rate impacts transmission capacities the most, and thus decreases the relative additional cost of national scale systems. Similarly, higher cost of wind capacities impact the continental scale system stronger and so decreases additional cost as well. Cost of bioenergy capacity, however, impacts the national scale system stronger and thus increases the additional cost of smaller scale systems. To reduce uncertainty of our results significantly, uncertainty in a single or a combination of these three parameters must be reduced.

![**Total Sobol' indices for combinations of all considered input uncertainties and selected model outputs of electricity systems on all scales.** Total Sobol' indices as result of a global sensitivity analysis determine the magnitude with which the variability of one model input explains the variability of one model output given assumptions on input variability. The x-axis comprises all twelve input parameters whose uncertainty we consider. See Supplementary Table 5 for a detailed compilation of all considered input uncertainty. See Supplementary Figures 3 and 4 for first-order and higher order Sobol' indices. **a,** Sobol' indices of input parameters considering total system cost and total installed capacities of the continental scale system. **b,** Sobol' indices of input parameters considering total system cost and total installed capacities of the national scale system. **c,** Sobol' indices of input parameters considering total system cost and total installed capacities of the regional scale system. **d,** Sobol' indices of input parameters considering difference in system cost between the continental and national scale systems. Framed Sobol' indices are referenced in the text.](report/total-sobol.png){#fig:sobol .class}

# Discussion and conclusions

We show that the geographic scale at which renewable electricity systems operate has a strong impact on the cost and design of the electricity system. Cost is lowest for a system on continental scale, higher on the national scale, and highest on the regional scale. The differences in cost come together with structural differences in the design of cost optimal systems: a system spanning all Europe needs significantly fewer supply capacities, in particular solar, and significantly fewer capacities providing flexible generation. Primarily the latter causes higher cost of national and regional scale systems. The continental system comes with much larger transmission capacities however --- roughly 4 times larger than today --- and with generation capacities that are strongly concentrated in space. On the national and regional scales, transmission needs are comparable to today's (albeit with different configuration) and generation is dispersed over the continent.

The trade-off between local generation and cost can be relieved with national or regional net self-sufficiency within a continental or national scale system. We show that the design of such systems resembles the one of small scale systems on the supply side: they require large total supply capacities and in particular large solar capacities. On the flexibility side however, they do not resemble small scale systems, and instead of relying on storage and bioenergy capacities they use their transmission grid connection to balance renewable fluctuations. Consequently, net self-sufficiency on the continental scale, but also on the national scale system are only slightly more expensive than their unconstrained counterparts.

Our findings are robust with respect to uncertainty in input parameters. Qualitatively, the relationship between geographic scale, cost, and design remains the same, no matter the combination of cost parameters we test. The strength of the effect, however, varies: in some cases national scale systems are only slightly more expensive and need only slightly more total supply, storage, and bioenergy capacity than continental systems. In some other cases, we find a much stronger effect leading for example to regional system cost as high as two times the continental system one's. These extreme cases are less likely but describe the range of possible options due to uncertainty in model parameters. Discount rate and installation cost of onshore wind and bioenergy capacities are the prevailing parameters in the relationship between geographic scale and cost.

Four aspects which our analysis does not consider may impact our findings. First, ignoring flexibilities stemming from the electricity demand or from coupling the electricity sector with the heat and transport sectors may leave small scale systems worse off in our study than they actually are. Based on the results of the sensitivity analysis, major contributions are more likely if these flexibilities are able to balance seasonal fluctuations. This is likely not the case for demand flexibility [@Aryandoust:2017] or transportation [@Brown:2018a], but it may be possible by coupling the electricity and the heat sectors [@Brown:2018a]. Second, necessary ancillary services may be easier and thus less costly provided in smaller scale systems, but there is no reason to believe that this would change system cost --- especially relative system cost --- significantly [@Brown:2018]. Third, cost of the distribution grid, on the other side, is likely to be higher for smaller systems with generation being dispersed more strongly, and in particular dispersed within the distribution grid [@ImperialCollegeLondon:2014]. Lastly, realisable potentials for solar and wind generation are likely to be lower than the vast technical potential we are considering in this study [@Trondle:2019]. Lower potentials will likely make electricity provision in small scale systems more expensive and it will make self-sufficiency impossible in more than the five regions in which self-sufficiency is impossible in our study. For a more comprehensive discussion of these four impacts, see Supplementary Note 2.

Our findings imply that fully renewable electricity supply is feasible on all geographic scales, from continental via national down to regional. While cost and required supply and flexibility capacities increase with smaller scales, these aspects are not prohibitive but instead provide a trade-off with the required level of cooperation and dependence on larger scales. Our findings thus add to existing policy knowledge that also smaller scale systems can provide low cost, fully renewable, and secure electricity supply.

# Acknowledgements

The work of T.T. and J.L. was supported by a European Research Council grant (TRIPOD project, grant agreement number 715132).

# Author contributions

T.T., J.L. and S.P. designed the study and wrote the main article. T.T. built the model, analysed the results, and carried out the bulk of the writing. S.P. and T.T. implemented necessary changes in the modelling framework Calliope. S.M. performed the sensitivity analysis and analysed its results. All authors contributed equally to editing and discussing the manuscript.

# Declarations of interest

None.

# Methods

We model the European electricity system as a set of network nodes and power flows between the nodes, with each node representing a regional administrative unit in Europe. We consider the deployment of certain renewable electricity supply and storage technologies at each node, and the deployment of transmission links between nodes, but disregard subordinate network nodes and power flows on the distribution system. We furthermore do not consider the current state of the electricity system, and thus employ a greenfield approach.

Using the Calliope model framework [@Pfenninger:2018b], we build a linear programming model that simultaneously optimises electricity system design and operation for a single year, 2016, with a temporal resolution of four hours. We choose a single year to reduce problem size, but we test our choice in a sensitivity analysis, see below. The objective function of the model is to find the design with the lowest total system cost. An electricity system design is defined by a set of supply capacities at each node, storage capacities at each node, and transmission capacities between all nodes. All system designs fulfilling Kirchhoff’s law, the technical constraints of all possible technology components, and political constraints (see below) are possible.

The model code and all analysis steps are publicly available as a reproducible workflow (TODO publish and add DOI). While the following text describes the modelling choices and assumptions made, the entirety of the model and all embedded assumptions are available for inspection through the repository linked to above.

## Geographic scope and transmission grid

The study area comprises all countries within member organisations ENTSO-E: EU-28, Norway, Switzerland, and Western Balkans countries. We exclude Iceland which is electricity autarkic, Cyprus, which is not directly connected to the rest of the study area, and Malta, for which insufficient data are available. We divide the study area into 497 regional administrative units [@Trondle:2019], and add a network node at the centroid of each region. We model the transmission grid as direct net transfer capacities between network nodes, i.e. we consider net power flows on the shortest distances between nodes only, and assume the distribution network within each node is able to handle distribution load. We allow transmission capacities between regional administrative units sharing a land border. We use currently existing sea connections and those that are currently under construction to connect regions that do not share a land border [@ENTSO-E:2019a]. We furthermore connect the islands Hiiu and Saare to the Estonian mainland to retrieve a fully connected electricity network graph as visible in Supplementary Figure 1.

## Electrical load

We determine electrical load profiles for each regional administrative unit following a method described in @Trondle:2019. First, we derive the location and annual demand of industrial facilities with highest electricity demand in Europe from emission data of the European Emission Trading Scheme [@EuropeanEnvironmentAgency:2018]. We assume industrial load to be nearly constant and thus derive flat industry profiles for each regional administrative unit.

Second, we use measured national load profiles of 2016 [@Muehlenpfordt:2019] (for Albania no data of 2016 is available and thus we use data of 2017) and subtract industrial demand to retrieve national profiles of residential and commercial load. We then assume residential and commercial load to be spatially distributed proportional to population counts. Using the Global Human Settlement Population Grid with a resolution of 250 m [@JRC:2015] we allocate residential and commercial load to regional administrative units.

Finally, we sum the two industrial and residential time series in each administrative unit to retrieve electricity load profiles at each network node.

## Photovoltaics

Photovoltaics (PV) can be built at each network node. For each administrative unit, we first determine the maximum amount of capacities that can be deployed. Then, we determine the capacity factor time series which maps from installed capacity to electricity generation in each point of time.

Our model differentiates between photovoltaics deployed on open fields and those deployed on roof tops. For the maximum amount of installable capacities, we use geo spatial data with a 10 arcsecond resolution.  We allow open field PV to be built on areas of bare land [@EuropeanSpaceAgency:2010] or open vegetation [@EuropeanSpaceAgency:2010] that are not environmentally protected [@UNEP-WCMC:2018], not inhabited (i.e. < 1% of the grid cell are buildings or urban greens according to @Ferri:2017), and whose average slope [@Reuter:2007; @Danielson:2011] is 10° at maximum [@AlGarni:2018]. We assume a capacity density of 80 W/m^2^ and derive the maximum amount of installable open field PV capacity for all regional administrative units.

For the maximum installable capacities of roof mounted PV, we consider inhabited areas only (i.e. >= 1% of the grid cell are buildings or urban greens according to @Ferri:2017). Within those grid cells, we use building footprints from @Ferri:2017 as a proxy for the amount of available roof tops. Using the high-resolution Sonnendach.ch data set for Switzerland [@SwissFederalOfficeofEnergy:2018], we find that within Switzerland, the ratio between building footprints from @Ferri:2017 and rooftops available for PV deployment is 0.56. Due to the lack of comparable data for other countries, we apply this ratio for all Europe to derive the maximum amount of roof space available for PV. We further differentiate between roof space on flat roofs and on tilted roofs based on the ratio from @SwissFederalOfficeofEnergy:2018 and assume capacity densities of 160 W/m^2^ for tilted roofs and 80 W/m^2^ for flat roofs.

We derive capacity factor time series for roof mounted and open-field PV on a mesh grid with 50 km edge length, resulting in around 2700 locations within the study area. We assume a performance ratio of 90% and simulate the time series using Renewables.ninja [@Staffell:2016; @Pfenninger:2016]. For roof mounted PV, because tilt and orientation of tilted roofs have a significant impact on capacity factors, we model 16 different deployment situations covering roofs facing east, south, west, and north, with tilts between 18° and 43°. We then weight and average the resulting 16 time series based on the distribution of roofs from @SwissFederalOfficeofEnergy:2018 to derive a single time series for roof mounted PV at each grid node. For open field PV we optimise the tilt based on location [@Jacobson:2018]. Eventually, we form one open field PV and one roof mounted PV time series for each administrative unit as a weighted spatial average from the ~2700 grid nodes.

Generation from photovoltaics can be curtailed, i.e. actual generation at a certain point in time can be lower than the maximum generation given by the installed capacities.

## Wind on- and offshore

Onshore and offshore wind capacities can be deployed at each network node, and we apply a method similar to the one for photovoltaics to derive their maximum amount of installable capacities and their capacity factor time series.

We use geospatial data with 10 arcsecond resolution to derive the maximum amount of installable wind power capacities. We allow onshore wind farms to be built on areas with farmland, forests, open vegetation, and bare land [@EuropeanSpaceAgency:2010] that are not environmentally protected [@UNEP-WCMC:2018], not inhabited (i.e. < 1% of the grid cell are buildings or urban greens according to @Ferri:2017), and whose average slope [@Reuter:2007; @Danielson:2011] is 20° at maximum [@McKenna:2015]. We allow offshore wind farms to be built in offshore areas within Exclusive Economic Zones [@Claus:2018] with water depths [@Amante:2009] not below 50 m and which are not environmentally protected [@UNEP-WCMC:2018]. We assume capacity densities of 8 W/m^2^ and 15 W/m^2^ [@EuropeanEnvironmentAgency:2009] for onshore and offshore wind. Where land is available for onshore wind farms and open field PV, either technology or a mix of both technologies can be used. We allocate the installable offshore capacities to regions which share a coast with the Exclusive Economic Zone, and where there is more than one region, we allocate the capacities proportional to the length of the shared coast.

We derive capacity factor time series for on- and offshore wind on the same 50 km^2^ grid as we do for PV, resulting in around 2700 onshore locations and around 2800 offshore locations. We again use Renewables.ninja [@Staffell:2016; @Pfenninger:2016] to simulate wind generation at each grid cell, assume capacity factors to be constant within the cell, and generate a spatially weighted average to generate a capacity factor time series for each regional administrative unit. Similar to PV, wind generation can be curtailed.

## Hydro run of river and reservoirs

We assume hydro run of river and hydro reservoir potentials to be largely tapped today [@LacalArantegui:2014] with almost no expansion potential. Thus, for hydro generation capacities we deviate from the greenfield approach and fix today's capacities. Similar to PV and wind generation, hydro generation can be curtailed.

We derive the location and installed power and storage capacities of hydro stations in Europe today from the JRC Hydro Power Database [@MatteoDeFelice:2019]. Where no storage capacity of hydro reservoirs is available, we use the median national ratio of power to storage capacity, and if that is not available, we use the median Europe-wide ratio of power to storage capacity.

To create power generation time series for each station, we use a two-stage approach. First, we derive water inflow time series for each station using an approach based on ERA5 runoff data [@Dee:2011] and hydrological basins [@Lehner:2013] described and validated for China in [@Liu:2019]. We use Atlite [@Andresen:2015] to first determine all basins upstream of the hydro power station to be able to sum all upstream runoff while assuming a water flow speed of 1 m/s.

Second, we are applying bias correction factors based on annual generation necessary for this method to represent the actual magnitude of the inflow and thus accurately model power generation. As we do not have data per station, we use national generation data from IRENA [@IRENA:2018a]. For hydro run of river plants we assume constant annual capacity factors within each country, which allows us to estimate the annual generation per plant. We use this estimation to derive electricity generation time series for each plant by scaling and capping the water inflow time series in such a way, that they sum to the annual generation without ever exceeding power capacities of the stations. For hydro reservoirs, we additionally assume they never need to spill water, i.e. their storage capacity is sufficient to use all inflowing water. We then scale the water inflow time series in such a way that they sum to the annual generation of the stations.

Using location data of each plant, we sum up time series as well as power and storage capacities per regional administrative unit. Our total resulting capacities are 36 GW for run of river and 103 GW / 97 TWh for reservoirs.

## Bioenergy

We use estimations of biomass potentials for the year 2020 and reference assumptions taken from @RuizCastello:2015, but we assume no dedicated farming for energy crops and thus consider residuals and wastes only. The data is given as national aggregates, and we use national shares of farmland [@EuropeanSpaceAgency:2010], national shares of forests [@EuropeanSpaceAgency:2010], and national shares of population [@JRC:2015] as proxies to derive proportionally allocated potentials per regional administrative unit. Supplementary Table 1 lists all feedstocks we consider together with the allocation proxy we use.

We assume an efficiency of 45% for the combustion of all biomass.

## Pumped hydro

Similar to hydro run of river and hydro reservoir capacities, we assume pumped hydro capacities in Europe to be largely tapped [@LacalArantegui:2014] and do not allow for capacity expansion. Thus, we deploy today's pumped hydro power and storage capacities. We assume a round-trip electricity efficiency of 78% [@Schmidt:2019].

To determine location, power and storage capacity of each pumped hydro station in Europe today, we also use the JRC Hydro Power Database [@MatteoDeFelice:2019]. Where storage capacities are missing, we employ the same method as for hydro reservoirs: we assume national median ratios of power to storage capacity for all stations with missing storage capacity; and where this is not available, we assume Europe-wide median ratios of power to storage capacity. Storage capacities within the JRC Hydro Power Database sum up to more than 10 TWh which is more than what other sources report (for example 1.3 TWh in [@Geth:2015]). We thus scale the storage capacities to match national data reported by @Geth:2015. Using location data of each station, we then sum all power and storage capacities within regional administrative units to form a single pumped hydro capacity per unit.

## Short-term and long-term storage

We assume that short-term and long-term storage capacities can be deployed in all regional administrative units. We model short-term as Lithium-ion batteries and long-term as hydrogen storage as they are likely to become the dominant technology in their respective applications [@Schmidt:2019]. We models are based on two technical parameters: the ratio between power and storage capacity, and the round-trip efficiency. Short-term storage is permitted to a maximum capacity of 4 h of full power, while long-term storage has a minimum of 4 h capacity at full power. We assume 86% of round-trip efficiency for short-term and 40% for long-term storage.

Additionally, we assume that power and storage capacities can be expanded independently, only limited by the above mentioned minimum/maximum storage capacities.

## Insufficient potentials

In some regions, local technical potential for renewable electricity is not high enough to satisfy local electricity demand [@Trondle:2019]. This is problematic in system layouts in which regions strive for self-sufficiency. To provide sufficient electricity supply in these regions, we connect them with a neighbouring or the encompassing region: Vienna with Lower Austria, Brussels with Flanders, Berlin with Brandenburg, Oslo with Akershus, and the canton of Basel-City with the canton of Basel-Country. So for the regional scale system, but also for continental and national scale systems with regional self-sufficiency, we actually require self-sufficiency of each combined region in these five corner cases.

## Technology cost

We assess long term (quasi steady state) cost of electricity supply. We aim neither to determine cost of a transition to such states nor to consider disruptive developments on the global market for supply and storage technologies. Thus, we assume expected learning-rate based cost once renewable supply and electricity storage are deployed at the large scales consistent with our study. Cost estimations for the year 2050 are primarily from [@JRC:2014] for supply and transmission technologies, from [@Schmidt:2019] for storage technologies, and from [@RuizCastello:2015] for fuel cost of bioenergy.

Technology cost is modelled as installed capacities cost, annual maintenance cost based on installed capacity, and variable cost per unit of generated electricity. For solar and wind we assume small variable cost of 0.1 €ct / kWh only to enforce curtailment whenever generation potential is higher than demand and storage capacities. We subtract these variable cost from the fixed operation and maintenance cost based on average capacity factors to not increase the overall cost of the technologies. Technology lifetime and cost of capital are used to derive annuities for each technology. For hydroelectricity, we consider annual maintenance and variable cost only as we assume capacities are already built today and as installation cost of hydroelectricity have no impact on our results. See Supplementary Table 2 for an overview of all cost assumptions.

We assume cost of capital to be 7.3% for all technologies and all locations based on historic average cost of capital for OECD countries [@Steffen:2019]. Some recent literature suggests cost of capital are likely specific to technology [@Egli:2018; @Steffen:2019] and location [@Ondraczek:2015; @Steffen:2019], but we consider the data available so far too sparse to provide a solid basis on which to model this.

## Political constraints

We use two types of political constraints as the basis for our system layouts: constraints on the geographic scale of the electricity system, and constraints regarding self-sufficiency. When we limit the scale of the system to continental, national, or regional sizes, we force transmission capacities of the electricity grid between continents, countries, or regions to be zero. For the continental scale this is given inherently by the scope of our study area.

When we enforce national or regional self-sufficiency in different degrees, we force all or parts of the electricity demand in the country or in the region to be satisfied with local electricity generation from wind, sun, biomass, and water. In contrast to the constraint on the system scale, the grid can still be used to balance fluctuations, as long as the required threshold for gross local generation is met.

## Sensitivity to meteorological conditions

We assess the sensitivity of our main result to meteorological conditions impacting generation from wind and solar power. While we use only a single year of meteorological conditions, 2016, in the analysis of system layouts, we use ten years, 2007--2016, in this sensitivity analysis. In this way, we are not assessing the variability between meteorological years, but we are assessing how much the result changes when considering a long duration of meteorological conditions. This will let us find electricity system layouts that are optimal for the entire range of years, not only for single years.

We assess the sensitivity of one of the main outputs of our study: relative total system cost of the national scale system using the continental scale system as a baseline. Because computational requirements to solve a model with regional spatial resolution and temporal resolution of 4h for ten years are too high, we perform this sensitivity analysis using a model with national spatial resolution while keeping temporal resolution the same. Comparing the results between national and regional resolution for the case with only one year of meteorological conditions, we find a difference of 8% for the relative cost of the national scale system.

The additional cost of the national scale system compared to the continental scale system, however, is unaffected by the longer time duration: the difference to the case with only one year is negligible (< 1‰). This is not to say that cost and design of the electricity system is not sensitive to meteorological conditions. In fact, we find that total system cost is generally slightly higher, and more wind and bioenergy capacities are deployed in exchange of solar capacities. However, large scale and small scale systems are impacted similarly and so the difference between both is unaffected by the longer time duration of considered meteorological conditions. These results justify the use of only a single meteorological year.

## Sensitivity to technology cost

We furthermore assess the uncertainty of our result stemming from uncertainty of technology cost. While we do know current cost and we do know that cost is likely to fall with deployment due to learning effects, we do not know exact future cost with certainty. This is mainly because it is unknown exactly how much technologies are deployed, and exactly how much cost will fall with deployment. Because in our analysis we are assuming technologies are deployed at large scale, the first aspect does not lead to much uncertainty. Uncertainty of technology cost in our analysis thus stems largely from the uncertain relationship of deployment and cost decreases. Being a cost optimisation, the absolute total system cost of any assessed electricity system layout can be sensitive to cost of technologies, as shown for example in ref. @Moret:2017. Here, we assess the sensitivity of the cost difference between large and small scale system layouts.

We consider ten technology cost parameters, the weighted cost of capital, and the availability of biomass for combustion as uncertain. Following a maximum entropy approach, we model their uncertainty with uniform distributions over ranges taken from literature (see Supplementary Table 5). We perform a global sensitivity analysis of the relative total system cost and several other model outputs in this twelve dimensional space. This allows us to derive the distribution of each model output and it allows us to derive total and first-order Sobol' indices. The Sobol' indices determine the share of the variation of each output that is explained by the variation of each input. Building on this, we use the indices to rank input parameters based on their importance for the uncertainty of each output. We find only low interaction between input parameters (total- and first-order indices are essentially identical) and thus ignore parameter interactions.

To derive the output distribution and Sobol' indices uncertainty needs to propagate through the model. In a classical Monte Carlo simulation, the input distributions are sampled many times to derive samples of the output. Because of the high computational requirements, in particular the long runtime of our model, this approach would be prohibitive for our study. Thus, we employ a method described in refs. @Sudret:2008 and @LeGratiet:2017 and implemented in the MATLAB package UQLab [@Marelli:2014], and perform a polynomial chaos expansion of our original model to derive a surrogate model. From this surrogate model, Sobol' indices can be determined analytically and the distribution of the outputs can be derived using Monte Carlo sampling. We derive the surrogate model by sampling 150 times from the input parameters using maximin Euclidean-distance-optimized Latin Hypercube Sampling, and running continental, national, and regional scale models each once for each input parameter vector.  Due to the high computational requirements of running national and continental scale models, we perform these runs on a spatial resolution with low fidelity in which each country represents one transmission grid node. To remove the biases these low fidelity model runs inhibit, we perform 10 additional runs on the original, high-fidelity resolution and use a multi-fidelity approach to retrieve a single surrogate model for continental and national scales. The estimated empirical error of the surrogate model is below 5% and thus we deem the surrogate usable to derive total- and first-order Sobol' indices.

# Bibliography
