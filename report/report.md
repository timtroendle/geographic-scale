# Introduction

A large body of work has shown that 100% or near-100% renewable electricity provision through solar, wind, and hydro power is technically possible and economically viable in Europe. The necessary technologies are available and increasingly mature [@Brown:2018; @IRENA:2019], there is enough land for the infrastructure required [@McKenna:2015; @Jacobson:2017; @Bodis:2019; @Trondle:2019], costs can be expected to be in a similar range as today [@Bussar:2014; @Connolly:2016; @Plessmann:2017; @Jacobson:2017; @Brown:2018; @Child:2019], and a range of options are available to balance the variability of renewable generation on time scales ranging from hours to years [@Rasmussen:2012; @Luo:2015; @Grams:2017; @Schlachtberger:2017; @Brown:2018]. However, the different strategies to deal with this variability each come with drawbacks and with dramatically different political and social implications across areas as diverse as system ownership, governance and political control, and landscape impacts [@Lilliestam:2016].  On one end of the spectrum are small-scale, decentralised solutions, often coupled with visions of local or regional autarky. Here, renewable fluctuations are mainly balanced locally in time, using electricity storage, curtailment of renewable generation, or by amending variable generation with flexible generation from biomass. On the other end are large-scale solutions, relying on stochastic smoothing of supply through very large and effective grids, spanning an entire continent or more [@Patt:2011; @Dii:2012; @Grams:2017; @Mano:2014; @Benasla:2019].

Here, we answer the question how geographic scale of the European electricity system impacts cost and structure of fully renewable electricity supply. We do this by modelling systems based on solar, wind, and hydro power, and bioenergy from residuals on different system scales across Europe, while dealing with the spatial-temporal variability of renewable generation. We apply a linear programming model on spatial resolution of first-level administrative divisions (497 regions) and 4h temporal resolution that minimises system cost by simultaneously optimising design and operation of the electricity system. Because some aspects of this model are uncertain, we furthermore perform a global sensitivity analysis on a surrogate model to determine uncertainties and sensitivities of our results.

There is reason to expect that, from a techno-economic perspective, a densely meshed continental system is cheaper than smaller, autarkic systems [@Schmid:2015; @Schlachtberger:2017; @Brown:2018a]. Nevertheless, the idea of citizen power, small-is-beautiful, and local, democratic control over the essential commodity electricity and its infrastructure has great appeal to many, citizens and decision-makers alike  [@Schmidt:2012; @Scheer:2012; @100RESCommunities:2015]. As a renewable future is possible in both locally autarkic and continental grids but the techno-political paths to achieve them are very different, the question of which path to take is a real one. In this paper, we investigate the trade-off between geographic scale, cost, and system structure: we can expect lower cost for a continental scale system, but neither do we know yet the exact cost differences for systems on different geographic scales nor do we know the relationship between scale and system structure. Here, we investigate the system performance of renewable electricity autarky on three political levels in Europe, from the continent-wide, via national to the regional level.

# Results

## System scale drives system costs

We first assess the impact of system scale on total system costs and find that system cost increases when system scale decreases. For a continental scale transmission grid, we find system costs corresponding to levelised cost of electricity of slightly below 0.05 € per kWh. However, when we consider transmission grids span countries only, with 33 isolated national grids, the costs rise by nearly 40%. When we decrease grid scale even further and consider no exchange between 497 regions in Europe, costs rise to 70% above costs for the system with continental scale grid. When we consider the uncertainty of technology costs and cost of capital in a global sensitivity analysis, we find that the relationship between grid scale and system cost is robust: the continental system always has cost lower than those of national systems. However, the extra cost of national scale varies significantly with input uncertainties. We find the national scale cost to lie in a range spanning from 110% to 140% of continental system cost in 80% of the cases. (TODO update those numbers)

Lower cost of systems with larger grids can be explained by providing additional options to balance renewable electricity supply and demand, and by the ability to generate electricity in places with beneficial resources and correspondingly lower costs of generation. To understand the impact of these two aspects on system cost we consider nine additional scenarios in which we restrict net imports and enforce local generation up to the point at which annual electricity demand in countries or regions is fulfilled entirely by local generation yet the transmission grid is still available to balance intra-annual fluctuations, see Figure @fig:scenario-space. We find that net imports have only minor impact on system cost, while the impact of the additional balancing options is significant. Prohibiting net imports into countries or regions on the continental scale leads to cost only 7% and 21% above the unconstrained case. When we allow to import up to 30% of annual electricity demand into countries or regions, cost decrease only slightly. Thus, generating electricity locally, in countries or regions, can be done with system costs very close to those of an electricity system in which electricity is generated in places with best wind and solar resources --- as long as a continental scale transmission grid exists that can be used sufficiently to balance fluctuations of renewable generation.

![**Minimal total system cost of twelve electricity systems on different scales in Europe, relative to lowest cost.** **a,** Minimal cost of continental scale systems in which a transmission grid spans the entire continent. In addition to the unconstrained, continental autarky case, there are six scenarios with national and regional autarky in which national or regional electricity demand is fulfilled mostly (net electricity imports ≤ 30% or ≤ 15%) or completely (net electricity imports = 0%) by local electricity generation. **b**, Minimal cost of national scale systems in which transmission grids connect regions within countries, but do not cross country borders. In addition to the otherwise unconstrained, national autarky case, there are three scenarios with regional autarky in which regional electricity demand is fulfilled mostly (net electricity imports ≤ 30% or ≤ 15%) or completely (net electricity imports = 0%) by electricity generation within regions. **c**, Minimal cost of regional scale electricity system. In this case, all regions are strictly autarkic and not connected in any way to other regions.](report/scenario-space.png){#fig:scenario-space .class}

## System scale drives composition and operation

Cost optimal electricity systems with different geographic scales have different compositions of supply and support technologies, with some technologies being more important for large systems and some technologies being more important for smaller systems. Not only are the systems differently composed, by the components are also differently operated. Indeed, the differences in total costs are driven by these system compositions and operations.

Small scale systems require significantly more generation capacities than large scale systems. In fact, despite having 50% larger generation capacities, the regional scale system has a generation potential below that of the continental scale system, see Figure @fig:composition. These numbers illustrate the large differences in quality of renewable resources that regions face: when regions have to rely on their local resources, which sometimes are much worse than the best resources, the Europe wide electricity yield per installed capacity is much lower. The lower yield drives up levelised cost of renewable electricity and thus this difference explains cost differences we find on the supply side. When we enforce local generation in large scale systems the situation changes and we see similar levels of generation capacities as we do for small scale systems. Here as well, regions have to rely on their local resources.

![**Cost minimal electricity system compositions for all scenarios. a,b,c,d**, Europe wide installed (**a**) generation capacities, (**b**) storage capacities, (**c**) transmission capacities, and (**d**) potential and curtailed generation from variable renewable sources (VRES) for continental, national, and regional scale electricity systems with minimal system costs. The thin bars indicate the range of values for scenarios with different geographic scale and strictness of electricity autarky within continental and national scale systems. See Supplementary Tables S3 and S4 for values of all twelve scenarios. **a**, Europe wide installed capacities of onshore and offshore wind, open-field and roof mounted solar, bioenergy, battery storage, hydrogen storage, and the total installed capacities. The total excludes all storage capacities but includes capacities of hydro electricity (36 GW run of river, 103 GW reservoirs) which are fixed in all scenarios. **b**, Europe wide installed storage capacities for battery and hydrogen storage. 97 TWh from hydro reservoirs and 1.3 TWh from pumped hydro storage are fixed in all scenarios and not shown. **c**, Europe wide installed electricity transmission capacities, ignoring transmission capacities within regions. **d**, Europe wide potential and curtailed generation from the variable renewable sources (VRES) solar, wind and hydro.](report/composition.png){#fig:composition .class}

Cost minimal large electricity systems comprise more transmission capacities and make use of these capacities more, see Figure @fig:composition. The continental scale system layout contains high voltage transmission capacity of nearly 400 TW km, which is roughly 4 times the current high-voltage grid [@ENTSO-E:2019] (CURRENT NUMBER CORRECT?). Using this capacity, about 3000 TWh electricity are crossing country borders, which, again, is roughly 4 times current cross-border electricity flows [@ENTSO-E:2019]. Of those 3000 TWh, roughly half remain as net imports within countries, which is more than 7 times the amount of today [@ENTSO-E:2019]. All these numbers are smaller when electricity is generated locally in a continental scale system, but transmission capacity and cross-border electricity flows in those cases are still 2-3 times today's values.

Because of the ability to use the transmission grid to balance demand and renewable supply, electricity systems with larger size require fewer other flexibility options. Indeed we find that the system with continental scale grid contains only moderate amounts of short-term electricity storage, long-term electricity storage, and bioenergy capacity, and requires less curtailment of renewable electricity than systems with smaller grids, see Figure @fig:composition. Larger systems generate the majority of their renewable electricity from onshore wind resources. This is in parts due to the low levelised cost of electricity of onshore wind at the best locations in Europe and because systems with continental grids can exploit the weather pattern of wind all over Europe on multiple timescales --- an ability that has been shown in previous literature [@Kempton:2010; @Grams:2017] and which exists for photovoltaics only for short timescales of up to several hours.

When we enforce local generation in larger scale systems, we only see a moderate increase of flexibility capacities. There are more storage capacities and more biofuel capacities installed, but the levels are still much lower than those of small scale systems. Instead, flexibility here comes through the transmission grid and through over capacities of renewable generation and their curtailment. Thus, while large scale systems with local generation resemble small scale systems on the supply side, they do not resemble them on the flexibility side. This explains the large cost difference between these two system layouts: electricity generation cost are roughly equal, but flexibility cost are much higher for small scale systems.

When we consider uncertainty in model inputs, we find that the differences in composition of continental scale and national scale systems are not very sensitive towards this uncertainty, see Figure @fig:variability. We find that cost optimal national scale systems almost always come with more total supply capacity, always come with more combined bioenergy and storage capacity, and often come with less wind capacity than cost optimal continental scale systems. There are, however, large differences in absolute numbers: total supply capacity ranges from below 1 TW to up to 2 TW, wind capacity ranges from almost 0 to sometimes more than 1 TW, and combined flexibility capacity from bioenergy and storage ranges from almost 0 to 0.5 TW. While the composition difference between systems on different scales is not very sensitive towards input uncertainty, compositions of the systems themselves are.

![**Variability of capacities installed in continental and national scale electricity systems considering uncertainty in input parameters.** Each panel shows a bivariate histogram of the joint distribution of variability within continental and national scale systems. Darker colours indicate more occurrences of values within 1,000,000 samples of the surrogate model. (TODO add values from the surrogate model instead from the main model.) **a,** Variability of total supply capacity comprising wind, solar, hydro, and bioenergy capacities. **b,** Variability of onshore and offshore wind capacity. **c,** Variability of bioenergy, short-term storage, and long-term storage capacities. For a detailed compilation of all considered input uncertainty, see Supplementary Table S5.](report/variability.png){#fig:variability .class}

## System scale impacts countries and regions differently

Locally, in countries and regions in Europe, the composition of the electricity system is very diverse and again dependent on the scale of the electricity system. For the case of the continental system, some countries and regions are equipped with much more generation capacities than others: Ireland, Lithuania, Estonia, and Albania all generate more than 4 times of what they actually consume. Large parts of their land are used to farm electricity for export. This effect is even more pronounced in single regions: several Irish counties facing the Atlantic ocean --- like Mayo, Kerry, or Cork ---, the Swedish island Gotland in the baltic sea, or Tulcea County at the Romanian shore of the black sea generate more than 50 times than what they need for themselves. Some of these exports are transmitted over long distances to their recipients, crossing many regions that merely pass through the electricity. In extreme cases, this amounts to more than 250 times local demand, for example in the central Ireland counties Laoighis, Tipperary, or Meath, where electricity from onshore wind turbines at the Atlantic ocean is on its way to United Kingdom and eventually central Europe. These Irish regions, but also other regions in Romania, Estonia, Montenegro, Switzerland, and other countries passing through large amounts of electricity are faced with large installations of transmission capacities which they do not, or only marginally benefit from directly. On the receiving end of these electricity trades are regions and countries that rely heavily, or sometimes completely, on imports: Belgium, Czech Republic, and Germany all feed less than 10% of their electricity demand with electricity generated locally.

On the other end of the scale, when regional electricity systems are isolated, levelised cost of electricity varies strongly between regions, depending on the renewable resources regions have available, see Figure @fig:map. About 10% of the regions has cost at least two times those of the continental case, and for half of them costs are at least four times those of the reference. Electricity supply in these regions is very expensive. There are three types of regions with high costs: regions with large hydro capacities, regions with low or no potential for wind capacities, and regions with low potential for biomass combustion.

![**System cost for each strictly autarkic unit on three electricity system scales, relative to lowest cost.** Strict autarky does not allow for any form of exchange of electricity between autarkic units. Each panel shows the system scale and the relative total system costs. Blue lines visualise net transfer capacities connecting regions. **a**, Relative system cost for the continental system. **b**, Relative system cost for each autarkic country. **c**, Relative system cost for each autarkic region.](report/map.png){#fig:map .class}

Because we force hydro capacities to exist where they exist today (see Methods), regions with hydro generation exceeding local demand have high generation cost. This is the case for several Swiss cantons (Graubünden, Uri, Valais, Glarus) and other alpine regions like Valle d'Aosta in Italy, but also in other parts of Europe, for example for Nikšic in Montenegro, or Jämtland in Sweden. Of course, this is an artefact of regional autarky, for which hydro stations have not been built for.

Several regions have low or no potential for wind capacities and thus their main source of electricity is the sun. But because solar generation has pronounced seasonal fluctuations in Europe (see Figure @fig:timeseries), these regions consequently require more flexible generation from bioenergy or hydroelectricity, or long-term electricity storage. Where the potential for wind, bioenergy, and hydroelectricity is low, costs are particularly high. This is mainly because balancing seasonal fluctuations using bioenergy is less costly than using hydrogen storage. However, when there are insufficient biomass residuals available to generate electricity, the utilisation of bioenergy capacities decreases (see Figure @fig:timeseries) and levelised cost of electricity of bioenergy increases. Further, hydrogen storage needs to be used to balance seasonal fluctuations in these regions, instead of using it to balance fluctuations between weeks and consecutive months for which it is cost optimal (see Figure @fig:timeseries). Especially urban regions have such low potentials for wind, bioenergy, and hydroelectricity, like Geneva, Prague, Budapest, and Bucharest. In Brussels, the Swiss canton Basel-Stadt, Berlin, Vienna, and Oslo the generation potential is too low for the region to be self-sufficient in the first place. To be able to fulfil their electricity demand, we connect them with their encompassing region or a neighbouring region, but even then some of them have high generation costs.

![**Dynamic, cost driving effects on the regional scale for all 497 regions. a,b,** Combined wind and solar weekly generation potential time series relative to local demand (**a**) for all regions where levelised cost of electricity is below 100 €/MWh and (**b**) for the 72 regions where it is above. Seasonal fluctuations are more pronounced for the case with higher costs due to higher shares of solar electricity. Weekly generation potential exceeds demand more than 2 times in some regions. Regions with high solar shares are often urban regions with low or no wind potential. **c,d,** Weekly generation time series from biomass combustion relative to installed combustion capacity (**c**) for all regions where levelised cost of electricity from bioenergy is below 250 €/MWh and (**d**) for 65 regions where it is above. High costs originate in low capacity utilisation when bioenergy potential is low. **e,f,** Weekly time series of hydrogen storage levels relative to installed storage capacity (**e**) for all regions where levelised cost of storage is below 400 €/MWh and (**f**) for 106 regions where it is above. In regions with higher costs, hydrogen storage is used primarily to balance seasonal fluctuations, instead of balancing fluctuations within weeks or months as it is done for lower cost regions, leading to fewer storage cycles and higher costs.](report/timeseries.png){#fig:timeseries .class}

# Discussion of uncertainties

While our main results are not sensitive towards meteorological conditions (see Methods), they are indeed sensitive towards other input parameters, especially cost parameters. Above, we show the variability of the additional cost of national scale compared to continental scale electricity systems. To identify which of the input parameters are driving the variability of the result the most, we perform a global sensitivity analysis and determine Total Sobol' indices of the input parameters. Total Sobol' indices represent the magnitude with which the uncertainty of a single input parameter explains the variability of a single output parameter; either directly or in combination with other parameters. We find that the uncertainty of three input parameters explains almost the entire variability of the additional cost of national scale systems: cost of capital (total Sobol' index 0.4), cost of bioenergy combustion capacity (total Sobol' index 0.3), and cost of onshore wind capacity (total Sobol' index of 0.15), see Figure @fig:sobol. Cost of capital impacts transmission capacities the most, and thus decreases the relative additional cost of national scale systems. Similarly, higher costs of wind capacities impact the continental scale system stronger and so decreases additional cost as well. Cost of bioenergy capacity, however, impacts the national scale system stronger and thus increases the additional cost of smaller scale systems.

![**Total Sobol' indices for all combinations of considered input uncertainties and model outputs of continental and national scale electricity systems.** Total Sobol' indices as result of a global sensitivity analysis determine the magnitude with which the variability of one model input explains the variability of one model output given assumptions on input variability. The x-axis comprises fifteen model outputs: absolute and relative system cost and installed generation, storage, and transmission capacity for the continental and the national scale system. The y-axis comprises all twelve input parameters whose uncertainty we consider: depreciation rate (d~r~), costs of solar (c~pv~), onshore wind (c~wind~), and offshore wind (c~offshore~) capacities, short-term storage power (c~sts,p~) and energy (c~sts,e~) capacities, long-term storage power (c~lts,p~) and energy (c~lts,e~) capacities, transmission (c~ntc~) and bioenergy (c~bio~) capacities, biomass fuel costs (c~fuel~) and biomass availability (a~bio~). See Supplementary Figures S1 and S2 for first-order and higher order Sobol' indices.](../data/total-sobol.png){#fig:sobol .class}

Four aspects which our analysis does not consider may impact our findings. First, ignoring flexibilities stemming from the electricity demand or from coupling the electricity sector with the heat and transport sectors may leave small scale systems worse off in our study than they actually are. Based on the results of the sensitivity analysis above, major contributions can only be expected if these flexibilities are able to balance seasonal fluctuations. This is likely not the case for demand flexibility [@Aryandoust:2017] or transportation [@Brown:2018a], but it may be possible by coupling the electricity and the heat sectors [@Brown:2018a]. Second, necessary ancillary services may be easier and thus less costly provided in smaller scale systems, but there is no reason to believe that this would change system cost --- especially relative system cost --- significantly [@Brown:2018]. Third, cost of the distribution grid, on the other side, is likely to be higher for smaller systems with generation being dispersed more strongly, and in particular dispersed within the distribution grid [@ImperialCollegeLondon:2014]. Lastly, realisable potentials for solar and wind generation are likely to be lower than the vast technical potential we are considering in this study [@Trondle:2019]. This will likely make electricity provision in small scale systems more expensive and it will make autarky impossible in more than the five regions in which autarky is impossible in our study. For a more comprehensive discussion of the impacts of these four impacts, see the Supplementary Material.

# Conclusions

Our analysis confirms that a fully renewable electricity system in Europe is possible on the continental, the national, and -- with one condition -- the regional scale. Total system cost increase when moving along the axis towards smaller scales, but the cost we find even for the smallest scale are not restrictive. A limiting condition on the regional scale is the technical potential of renewable electricity, which is sometimes not large enough to enable regional scale electricity systems. In general, we find that larger systems come not only with lower cost, but also with fewer generation capacities, fewer bioenergy and storage capacities, but more transmission capacities. Smaller systems are more dependent on their local resources and thus some regions require large shares of local land be used for generation [@Trondle:2019] or have high levelised cost of electricity. While we identify cost optimal system designs only, we speculate that system composition and cost can be traded in in certain cases. For example, it may be possible to reduce total supply capacities by increasing storage capacities and cost. A cost optimal comprise we identify are large systems with local generation, which share traits of both, large and small systems.

Regardless which scale is preferred in Europe, it is crucial that a decision is made purposefully among all stakeholders, and the electricity system is developed in a way that fits the chosen grid scale. All system designs we identify are only reached when the entire system is considered and its layout and operation optimised. But systems with higher land use, more capacity needs, and higher costs are possible when this is not done. For systems with large scale grids, the current transmission grid must be expanded, which is not only a necessary condition for such systems, but also an important signal for political and economic stakeholders. Furthermore, such a system needs institutional and public support: there must be backing from the population for expanding transmission capacities, the installation of generation and transmission capacity must happen in a coordinated fashion among partners in Europe, and a strong and trusted market for electricity trading must be established.

A decision for smaller scale systems may be easier to make, as fewer stakeholders are involved. Generally, small scale systems need less cooperation. But their development must happen in a coordinated and systematic fashion to reap the benefits of their system scales: these systems need more generation capacity, especially inexpensive solar electricity, and they need more flexible generation and storage. Building such a system requires institutional and public support as well: there must be backing from the population for expanding generation capacities and likely for higher prices of electricity, and market mechanisms must be set in place that attract investments into generation capacities that are not generating at their full potential. As we show, more wind and solar electricity is curtailed in these systems, and bioenergy is largely used in the winter months when solar electricity generation is low. The transition of the European electricity system towards a decarbonised supply must be based on these traits of systems on different geographic scales.

# Methods

We model the European electricity system as a set of network nodes and power flows between the nodes, with each node representing a regional administrative unit in Europe. We consider the deployment of certain renewable electricity supply and storage technologies at each node, and the deployment of transmission links between nodes, but disregard subordinate network nodes and power flows on the distribution system. We furthermore do not consider the current state of the electricity system, and thus employ a greenfield approach.

Using the Calliope model framework [@Pfenninger:2018b], we build a linear programming model that simultaneously optimises electricity system design and operation for a single year, 2016, with a temporal resolution of four hours. We choose a single year to reduce problem size, but we test our choice in a sensitivity analysis, see below. The objective function of the model is to find the design with the lowest total system costs. An electricity system design is defined by a set of supply capacities at each node, storage capacities at each node, and transmission capacities between all nodes. All system designs fulfilling Kirchhoff’s law, the technical constraints of all possible technology components, and political constraints (see below) are possible.

The model code and all analysis steps are publicly available as a reproducible workflow (TODO publish and add DOI). While the following text describes the modelling choices and assumptions made, the entirety of the model and all embedded assumptions are available for inspection through the repository linked to above.

## Geographic scope and transmission grid

The study area comprises all countries within member organisations ENTSO-E: EU-28, Norway, Switzerland, and Western Balkans countries. We exclude Iceland which is electricity autarkic, Cyprus, which is not directly connected to the rest of the study area, and Malta, for which insufficient data are available. We divide the study area into 497 regional administrative units [@Trondle:2019], and add a network node at the centroid of each region. We model the transmission grid as direct net transfer capacities between network nodes, i.e. we consider net power flows on the shortest distances between nodes only, and assume the distribution network within each node is able to handle distribution load. We allow transmission capacities between regional administrative units sharing a land border. We use currently existing sea connections and those that are currently under construction to connect regions that do not share a land border [@ENTSO-E:2019a]. We furthermore connect the islands Hiiu and Saare to the Estonian mainland to retrieve a fully connected electricity network graph as visible in Figure @fig:map.

## Electrical load

We determine electrical load profiles for each regional administrative unit following a method described in @Trondle:2019. First, we derive the location and annual demand of industrial facilities with highest electricity demand in Europe from emission data of the European Emission Trading Scheme [@EuropeanEnvironmentAgency:2018]. We assume industrial load to be nearly constant and thus derive flat industry profiles for each regional administrative unit.

Second, we use measured national load profiles of 2016 [@Muehlenpfordt:2019] (for Albania no data of 2016 is available and thus we use data of 2017) and subtract industrial demand to retrieve national profiles of residential and commercial load. We then assume residential and commercial load to be spatially distributed proportional to population counts. Using the Global Human Settlement Population Grid with a resolution of 250 m [@JRC:2015] we allocate residential and commercial load to regional administrative units.

Finally, we sum the two industrial and residential time series in each administrative unit to retrieve electricity load profiles at each network node.

## Photovoltaics

Photovoltaics (PV) can be built at each network node. For each administrative unit, we first determine the maximum amount of capacities that can be deployed. Then, we determine the capacity factor time series which maps from installed capacity to electricity generation in each point of time.

Our model differentiates between photovoltaics deployed on open fields and those deployed on roof tops. For the maximum amount of installable capacities, we use geo spatial data with a 10 arcsecond resolution.  We allow open field PV to be built on areas of bare land [@EuropeanSpaceAgency:2010] or open vegetation [@EuropeanSpaceAgency:2010] that are not environmentally protected [@UNEP-WCMC:2018], not inhabited (i.e. < 1% of the grid cell are buildings or urban greens according to @Ferri:2017), and whose average slope [@Reuter:2007; @Danielson:2011] is 10° at maximum [@AlGarni:2018]. We assume a capacity density of 80 W/m^2^ and derive the maximum amount of installable open field PV capacity for all regional administrative units.

For the maximum installable capacities of roof mounted PV, we consider inhabited areas only (i.e. >= 1% of the grid cell are buildings or urban greens according to @Ferri:2017). Within those grid cells, we use building footprints from @Ferri:2017 as a proxy for the amount of available roof tops. Using the high-resolution Sonnendach.ch data set for Switzerland [@SwissFederalOfficeofEnergy:2018], we find that within Switzerland, the ratio between building footprints from @Ferri:2017 and rooftops available for PV deployment is 0.56. Due to the lack of comparable data for other countries, we apply this ratio for all Europe to derive the maximum amount of roof space available for PV. We further differentiate between roof space on flat roofs and on tilted roofs based on the ratio from @SwissFederalOfficeofEnergy:2018 and assume capacity densities of 160 W/m^2^ for tilted roofs and 80 W/m^2^ for flat roofs.

We derive capacity factor time series for roof mounted and open-field PV on a mesh grid with 50 km edge length, resulting in around 2700 locations within the study area. We assume a performance ratio of 90% and simulate the time series using Renewables.ninja [@Staffell:2016; @Pfenninger:2016]. For roof mounted PV, because tilt and orientation of tilted roofs have a significant impact on capacity factors, we model 16 different deployment situations covering roofs facing east, south, west, and north, with tilts between 18° and 43°. We then weight and average the resulting 16 time series based on the distribution of roofs from @SwissFederalOfficeofEnergy:2018 to derive a single time series for roof mounted PV at each grid node. For open field PV we optimise the tilt based on location [@Jacobson:2018]. Eventually, we form one open field PV and one roof mounted PV time series for each administrative unit as a weighted spatial average from the ~2700 grid nodes.

Generation from photovoltaics can be curtailed, i.e. actual generation at a certain point in time can be lower than the maximum generation given by the installed capacities.

## Wind on- and offshore

Onshore and offshore wind capacities can be deployed at each network node, and we apply a method similar to the one for photovoltaics to derive their maximum amount of installable capacities and their capacity factor time series.

We use geospatial data with 10 arcsecond resolution to derive the maximum amount of installable wind power capacities. We allow onshore wind farms to be built on areas with farmland, forests, open vegetation, and bare land [@EuropeanSpaceAgency:2010] that are not environmentally protected [@UNEP-WCMC:2018], not inhabited (i.e. < 1% of the grid cell are buildings or urban greens according to @Ferri:2017), and whose average slope [@Reuter:2007; @Danielson:2011] is 20° at maximum [@McKenna:2015]. We allow offshore wind farms to be built in offshore areas within Exclusive Economic Zones [@Claus:2018] with water depths [@Amante:2009] not below 50 m and which are not environmentally protected [@UNEP-WCMC:2018]. We assume capacity densities of 8 W/m^2^ and 15 W/m^2^ [@EuropeanEnvironmentAgency:2009] for onshore and offshore wind. Where land is available for onshore wind farms and open field PV, either technology or a mix of both technologies can be used. We allocate the installable offshore capacities to regions which share a coast with the Exclusive Economic Zone, and where there is more than one region, we allocate the capacities proportional to the length of the shared coast.

We derive capacity factor time series for on- and offshore wind on the same 50 km^2^ grid as we do for PV, resulting in around 2700 onshore locations and around 2800 offshore locations. We again use Renewables.ninja [@Staffell:2016; @Pfenninger:2016] to simulate wind generation at each grid cell, assume capacity factors to be constant within the cell, and generate a spatially weighted average to generate a capacity factor time series for each regional administrative unit. Similar to PV, wind generation can be curtailed.

## Hydro run of river and reservoirs

We assume hydro run of river and hydro reservoir potentials to be largely tapped today [@LacalArantegui:2014] with almost no expansion potential. Thus, for hydro generation capacities we deviate from the greenfield approach and fix today's capacities. Similar to PV and wind generation, hydro generation can be curtailed.

We derive the location and installed power and storage capacities of hydro stations in Europe today from the JRC Hydro Power Database [@MatteoDeFelice:2019]. Where no storage capacity of hydro reservoirs is available, we use the median national ratio of power to storage capacity, and if that is not available, we use the median Europe-wide ratio of power to storage capacity.

To create power generation time series for each station, we use a two-stage approach. First, we derive water inflow time series for each station using an approach based on ERA5 runoff data [@Dee:2011] and hydrological basins [@Lehner:2013] described and validated for China in [@Liu:2019]. We use Atlite [@Andresen:2015] to first determine all basins upstream of the hydro power station to be able to sum all upstream runoff while assuming a water flow speed of 1 m/s.

Second, we are applying bias correction factors based on annual generation necessary for this method to represent the actual magnitude of the inflow and thus accurately model power generation. As we do not have data per station, we use national generation data from IRENA [@IRENA:2018a]. For hydro run of river plants we assume constant annual capacity factors within each country, which allows us to estimate the annual generation per plant. We use this estimation to derive electricity generation time series for each plant by scaling and capping the water inflow time series in such a way, that they sum to the annual generation without ever exceeding power capacities of the stations. For hydro reservoirs, we additionally assume they never need to spill water, i.e. their storage capacity is sufficient to use all inflowing water. We then scale the water inflow time series in such a way that they sum to the annual generation of the stations.

Using location data of each plant, we sum up time series as well as power and storage capacities per regional administrative unit. Our total resulting capacities are 36 GW for run of river and 103 GW / 97 TWh for reservoirs.

## Bioenergy

We use estimations of biomass potentials for the year 2020 and reference assumptions taken from @RuizCastello:2015, but we assume no dedicated farming for energy crops and thus consider residuals and wastes only. The data is given as national aggregates, and we use national shares of farmland [@EuropeanSpaceAgency:2010], national shares of forests [@EuropeanSpaceAgency:2010], and national shares of population [@JRC:2015] as proxies to derive proportionally allocated potentials per regional administrative unit. Supplementary Table S1 lists all feedstocks we consider together with the allocation proxy we use.

We assume an efficiency of 45% for the combustion of all biomass.

## Pumped hydro

Similar to hydro run of river and hydro reservoir capacities, we assume pumped hydro capacities in Europe to be largely tapped [@LacalArantegui:2014] and do not allow for capacity expansion. Thus, we deploy today's pumped hydro power and storage capacities. We assume a round-trip electricity efficiency of 78% [@Schmidt:2019].

To determine location, power and storage capacity of each pumped hydro station in Europe today, we also use the JRC Hydro Power Database [@MatteoDeFelice:2019]. Where storage capacities are missing, we employ the same method as for hydro reservoirs: we assume national median ratios of power to storage capacity for all stations with missing storage capacity; and where this is not available, we assume Europe-wide median ratios of power to storage capacity. Storage capacities within the JRC Hydro Power Database sum up to more than 10 TWh which is more than what other sources report (for example 1.3 TWh in [@Geth:2015]). We thus scale the storage capacities to match national data reported by @Geth:2015. Using location data of each station, we then sum all power and storage capacities within regional administrative units to form a single pumped hydro capacity per unit.

## Short-term and long-term storage

We assume that short-term and long-term storage capacities can be deployed in all regional administrative units. We model short-term as Lithium-ion batteries and long-term as hydrogen storage as they are likely to become the dominant technology in their respective applications [@Schmidt:2019]. We models are based on two technical parameters: the ratio between power and storage capacity, and the round-trip efficiency. Short-term storage is permitted to a maximum capacity of 4 h of full power, while long-term storage has a minimum of 4 h capacity at full power. We assume 86% of round-trip efficiency for short-term and 40% for long-term storage.

Additionally, we assume that power and storage capacities can be expanded independently, only limited by the above mentioned minimum/maximum storage capacities.

## Insufficient potentials

In some regions, local technical potential for renewable electricity is not high enough to satisfy local electricity demand [@Trondle:2019]. This is problematic in system layouts in which regions strive for electricity autarky. To provide sufficient electricity supply in these regions, we connect them with a neighbouring or the encompassing region: Vienna with Lower Austria, Brussels with Flanders, Berlin with Brandenburg, Oslo with Akershus, and the canton of Basel-City with the canton of Basel-Country. So when we require regional autarky, we actually require autarky of each combined region in these five corner cases.

## Technology costs

We assess long term (quasi steady state) cost of electricity supply. We aim neither to determine costs of a transition to such states nor to consider disruptive developments on the global market for supply and storage technologies. Thus, we assume expected learning-rate based costs once renewable supply and electricity storage are deployed at the large scales consistent with our study. Cost estimations for the year 2050 are primarily from [@JRC:2014] for supply and transmission technologies, from [@Schmidt:2019] for storage technologies, and from [@RuizCastello:2015] for fuel costs of bioenergy.

Technology costs are modelled as installed capacities costs, annual maintenance costs based on installed capacity, and variable costs per unit of generated electricity. For solar and wind we assume small variable costs of 0.1 €ct / kWh only to enforce curtailment whenever generation potential is higher than demand and storage capacities. We subtract these variable costs from the fixed operation and maintenance cost based on average capacity factors to not increase the overall cost of the technologies. Technology lifetime and costs of capital are used to derive annuities for each technology. For hydroelectricity, we consider annual maintenance and variable costs only as we assume capacities are already built today and as installation costs of hydroelectricity have no impact on our results. See Supplementary Table S2 for an overview of all cost assumptions.

We assume costs of capital to be 7.3% for all technologies and all locations based on historic average cost of capital for OECD countries [@Steffen:2019]. Some recent literature suggests costs of capital are likely specific to technology [@Egli:2018; @Steffen:2019] and location [@Ondraczek:2015; @Steffen:2019], but we consider the data available so far too sparse to provide a solid basis on which to model this.

## Political constraints

We use two types of political constraints as the basis for our system layouts: constraints on the scale of the electricity grid, and constraints on net electricity imports. When we limit the scale of the grid to continental, national, or regional sizes, we force transmission capacities between continents, countries, or regions to be zero. For the continental scale this is given inherently by the scope of our study area.

When we limit net imports into continental, national, or regional areas leading to full or partial autarky, we force all or parts of the electricity demand on the continent, in the country, or in the region to be satisfied with local electricity generation from wind, sun, biomass, and water. In contrast to the constraint on the grid scale, the grid can still be used to balance fluctuations, as long as net annual imports stay below the required threshold.

## Sensitivity to meteorological conditions

We assess the sensitivity of our main result to meteorological conditions impacting generation from wind and solar power. While we use only a single year of meteorological conditions, 2016, in the analysis of system layouts, we use ten years, 2007--2016, in this sensitivity analysis. In this way, we are not assessing the variability between meteorological years, but we are assessing how much the result changes when considering a long duration of meteorological conditions. This will let us find electricity system layouts that are optimal for the entire range of years, not only for single years.

We assess the sensitivity of relative total system costs of national autarky with continental autarky as a baseline. Because computational requirements to solve a model with regional spatial resolution and temporal resolution of 4h for ten years are very high, we perform this sensitivity analysis using a model with national spatial resolution while keeping temporal resolution the same. Comparing the results between national and regional resolution for the case with only one year of meteorological conditions, we find a difference of 6% for the relative costs of national autarky.

The additional cost of national autarky compared to continental autarky, however, is unaffected by the longer time duration: the difference to the case with only one year is negligible (< 3‰). This is not to say that the electricity system layout is not sensitive to meteorological conditions. In fact, we find that total system costs are generally slightly higher, and more wind and bioenergy capacities are deployed in exchange of solar capacities. However, large scale and small scale system layouts are impacted similarly and so the difference between both is unaffected by the longer time duration of considered meteorological conditions. These results justify the use of only a single meteorological year.

## Sensitivity to technology costs

We furthermore assess the uncertainty of our result stemming from uncertainty of technology costs. While we do know current costs and we do know that costs are likely to fall with deployment due to learning effects, we do not know exact future costs with certainty. This is mainly because it is unknown exactly how much technologies are deployed, and exactly how much costs will fall with deployment. Because in our analysis we are assuming technologies are deployed at large scale, the first aspect does not lead to much uncertainty. Uncertainty of technology costs in our analysis thus stems largely from the uncertain relationship of deployment and cost decreases. Being a cost optimisation, the absolute total system costs of any assessed electricity system layout can be sensitive to costs of technologies, as shown for example in @Moret:2017. Here, we assess the sensitivity of the cost difference between large and small scale system layouts.

We consider ten technology cost parameters, the weighted cost of capital, and the availability of biomass for combustion as uncertain and describe their uncertainty by an uniform distribution over ranges taken from literature (see Supplementary Table S5). We perform a global sensitivity analysis of the additional costs of national autarky compared to continental autarky and several other model outputs in this twelve dimensional space. This allows us to describe the uncertainty of each model output by a distribution and it allows us to derive total and first-order Sobol' indices. The Sobol' indices determine the share of the variation of each output that is explained by the variation of each input. Building on this characteristic, we use the indices to rank input parameters based on their importance for the uncertainty of each output. We find only low interaction between input parameters (higher than first-order indices are very small) and thus ignore parameter interactions.

To derive the output distribution and Sobol' indices uncertainty is propagated through the model: after determining the input uncertainty, the input distributions are sampled many times to derive samples of the output. Because of the high computational requirements, in particular the long runtime of our model, this method is prohibitive for our study. Thus, we employ a method described in @Sudret:2008 and implemented in the MATLAB package UQLab [@Marelli:2014], and derive a surrogate model of our original model using polynomial chaos expansion. From this surrogate model, Sobol' indices can be determined analytically and the distribution of the outputs can be derived using Monte Carlo sampling. We derive the surrogate model by sampling 150 times from the input parameters using maximin Euclidean-distance-optimized Latin Hypercube Sampling, and running the large scale and small scale models each once for each input parameter vector. The estimated empirical error of the surrogate model is below 5% and thus we deem the surrogate usable to derive Total and first-order Sobol' indices.

# Bibliography
